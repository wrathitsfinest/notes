<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes - Your Personal Note-Taking App</title>
    <meta name="description"
        content="A beautiful and simple note-taking application to capture your thoughts and ideas.">

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#a05aff">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="My Notes">

    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="512x512" href="./icons/icon-512x512.png">
    <link rel="apple-touch-icon" sizes="512x512" href="./icons/icon-512x512.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle menu">
                    <span class="hamburger-icon"></span>
                </button>
                <h1 class="app-title">
                    <span class="title-text" id="appTitle">My Notes</span>
                    <span class="title-count" id="appTitleCount"></span>
                </h1>
                <button class="btn-icon-action hidden" id="editGroupBtn" title="Group Settings">
                    <svg class="header-svg" version="1.0" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 783.000000 784.000000" preserveAspectRatio="xMidYMid meet">
                        <g transform="translate(0.000000,784.000000) scale(0.100000,-0.100000)"
                            fill="var(--text-primary)" stroke="none">
                            <path
                                d="M1493 6165 c-29 -8 -70 -23 -90 -34 -52 -27 -125 -105 -159 -171 l-29 -55 -3 -1945 c-1 -1332 1 -1961 8 -1996 6 -28 19 -66 30 -86 10 -19 23 -53 29 -75 17 -63 73 -127 138 -160 l58 -28 2335 0 2335 0 55 22 c109 45 214 158 245 267 8 28 44 256 80 506 117 806 179 1228 290 1975 75 503 75 496 31 590 -48 105 -139 156 -292 163 l-101 5 -5 88 c-10 163 -97 296 -236 362 l-67 32 -1170 5 c-1098 5 -1172 6 -1206 23 -64 32 -98 78 -139 187 -79 208 -152 285 -307 325 -83 22 -1750 21 -1830 0z m1855 -209 c48 -33 81 -84 107 -166 41 -129 98 -210 188 -271 110 -73 34 -69 1312 -71 l1150 -3 40 -22 c83 -44 115 -104 115 -213 l0 -70 -491 0 c-462 0 -490 -1 -485 -17 3 -10 18 -51 34 -92 l27 -75 636 -1 c708 -1 671 3 705 -69 15 -30 14 -46 -10 -222 -15 -104 -31 -211 -36 -239 -5 -27 -34 -228 -65 -445 -31 -217 -60 -404 -65 -415 -6 -13 -9 15 -9 83 -1 109 -14 152 -50 172 -10 5 -90 32 -177 60 -88 28 -165 54 -172 58 -7 4 -25 33 -39 65 l-26 58 82 167 c45 92 81 175 81 185 0 10 -5 28 -11 40 -15 27 -335 358 -363 374 -39 23 -72 13 -237 -72 l-165 -84 -58 23 c-32 13 -61 28 -66 32 -4 5 -36 89 -71 188 -55 158 -66 181 -93 197 -28 17 -54 19 -283 19 l-251 0 -30 -25 c-25 -21 -41 -56 -86 -193 -31 -92 -60 -172 -64 -178 -4 -6 -33 -23 -66 -37 l-58 -27 -171 86 c-147 74 -175 85 -206 80 -29 -4 -65 -35 -213 -183 -185 -185 -205 -214 -189 -271 5 -15 43 -93 85 -174 l77 -146 -33 -66 c-18 -36 -37 -66 -44 -66 -19 0 -322 -99 -343 -111 -47 -30 -51 -52 -51 -312 0 -319 -18 -289 230 -373 l185 -62 27 -62 28 -63 -80 -165 c-53 -110 -80 -176 -80 -200 0 -30 11 -46 83 -121 46 -47 124 -128 173 -179 93 -98 127 -122 167 -122 14 0 98 36 186 80 89 44 167 80 174 80 6 0 35 -10 64 -22 58 -24 57 -22 133 -263 43 -136 45 -141 77 -162 24 -16 56 -18 264 -21 321 -4 311 -9 374 183 19 61 47 139 61 175 24 63 27 66 83 92 l59 26 167 -85 c212 -108 204 -109 333 19 51 51 134 137 184 191 117 126 117 120 10 333 l-81 161 32 64 32 64 183 60 182 60 -5 -30 c-3 -16 -43 -293 -90 -615 -94 -645 -95 -647 -173 -707 -24 -18 -59 -37 -80 -43 -49 -13 -4560 -14 -4596 0 -14 5 -34 18 -46 30 -26 26 -26 90 0 265 10 72 37 254 60 405 23 151 54 363 70 470 87 583 112 757 145 975 132 893 129 879 192 936 60 54 81 61 202 70 64 4 584 8 1156 8 572 0 1049 0 1060 1 17 0 26 15 48 83 15 46 27 86 27 90 0 4 -541 6 -1202 5 l-1203 -3 -57 -23 c-127 -51 -239 -167 -266 -274 -11 -41 -38 -221 -112 -723 -38 -255 -112 -751 -140 -935 -12 -74 -26 -172 -32 -217 -7 -46 -15 -83 -20 -83 -4 0 -7 672 -6 1493 l3 1493 27 42 c16 23 45 50 65 61 37 20 57 20 928 18 l890 -2 43 -29z m1736 -1203 c54 -164 63 -182 86 -188 14 -3 78 -29 143 -56 l117 -51 163 85 164 84 118 -116 118 -116 -85 -167 -84 -167 47 -96 c26 -53 53 -116 60 -141 13 -44 14 -45 84 -65 38 -12 115 -34 170 -51 55 -16 108 -32 118 -34 15 -5 17 -21 17 -157 0 -84 -4 -157 -8 -162 -4 -6 -89 -37 -188 -69 l-181 -59 -18 -56 c-10 -31 -37 -94 -60 -141 l-43 -85 85 -169 85 -169 -120 -120 -120 -119 -164 86 -165 86 -94 -44 c-52 -24 -116 -51 -142 -61 -38 -14 -49 -24 -54 -46 -3 -15 -29 -99 -57 -186 l-52 -158 -165 1 -164 2 -62 182 c-34 101 -65 186 -70 190 -4 3 -39 19 -78 35 -38 16 -96 41 -128 57 l-58 29 -171 -88 -172 -87 -116 122 -116 123 84 166 84 166 -45 96 c-25 53 -53 119 -64 146 l-19 50 -180 55 -179 56 -3 161 -2 162 72 21 c40 12 122 36 182 53 l109 33 37 89 c20 50 49 114 64 144 l27 53 -35 67 c-19 36 -57 111 -85 166 l-51 100 117 117 118 117 169 -85 168 -86 77 35 c42 19 104 45 138 57 l61 22 50 147 c27 80 55 163 62 184 l12 37 166 -2 166 -3 60 -182z" />
                            <path
                                d="M4710 4099 c-119 -30 -195 -74 -286 -164 -59 -58 -91 -100 -117 -151 -107 -214 -94 -447 35 -640 216 -322 682 -368 956 -93 112 113 169 244 179 410 18 303 -180 567 -478 639 -104 25 -192 25 -289 -1z m338 -214 c98 -49 163 -114 208 -209 77 -162 48 -347 -74 -479 -91 -97 -187 -138 -322 -138 -126 0 -216 37 -310 127 -95 90 -135 198 -128 337 8 150 92 280 226 350 92 48 130 57 235 53 78 -3 97 -8 165 -41z" />
                        </g>
                    </svg>
                </button>
                <button class="btn-icon-action hidden" id="editNoteBtn" title="Note Settings">
                    <svg class="header-svg" version="1.0" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 783.000000 784.000000" preserveAspectRatio="xMidYMid meet">
                        <g transform="translate(0.000000,784.000000) scale(0.100000,-0.100000)"
                            fill="var(--text-primary)" stroke="none">
                            <path
                                d="M2857 6213 c-16 -8 -272 -255 -568 -551 -460 -460 -539 -542 -544 -572 -3 -19 -4 -758 -3 -1642 l3 -1608 33 -32 32 -33 722 -3 c797 -3 755 -6 783 60 15 37 5 82 -25 113 -20 20 -32 20 -685 23 l-665 2 0 1505 0 1505 483 0 c365 0 488 3 507 13 14 7 33 28 43 47 16 31 17 68 17 345 -1 171 -1 385 0 478 l0 167 895 0 895 0 0 -600 c0 -641 1 -654 48 -679 36 -19 80 -13 112 17 l31 27 -1 678 c0 442 -4 685 -10 698 -29 52 21 50 -1065 52 -800 2 -1013 0 -1038 -10z m-67 -688 l0 -345 -345 0 c-190 0 -345 3 -345 7 0 10 673 683 682 683 5 0 8 -155 8 -345z" />
                            <path
                                d="M2560 4493 c-91 -8 -132 -95 -76 -160 l24 -28 642 -3 642 -2 34 34 c19 19 34 44 34 55 0 32 -27 79 -52 92 -16 9 -182 12 -613 14 -324 1 -610 0 -635 -2z" />
                            <path
                                d="M4593 4480 c-40 -24 -52 -47 -97 -193 l-37 -118 -83 -41 -84 -41 -145 67 c-194 90 -172 97 -399 -131 -228 -230 -224 -216 -112 -424 l66 -122 -39 -85 -39 -85 -136 -43 c-115 -37 -141 -49 -166 -78 l-30 -34 -4 -244 c-6 -337 -11 -329 204 -393 l127 -38 41 -85 40 -84 -64 -122 c-72 -137 -84 -177 -64 -224 17 -42 333 -360 375 -378 18 -8 40 -14 50 -14 10 0 81 29 157 65 l138 64 84 -42 85 -42 35 -115 c20 -63 43 -129 51 -147 26 -56 51 -61 323 -63 135 -2 253 -2 262 -1 10 0 33 15 53 32 30 27 41 49 77 166 35 112 46 137 65 144 13 5 50 22 83 38 l60 30 138 -64 c75 -36 145 -65 155 -65 49 0 99 38 251 193 154 158 186 201 186 251 0 14 -29 83 -65 155 -36 71 -65 133 -65 133 0 7 39 97 63 143 10 20 37 33 146 67 104 33 141 50 165 73 l31 31 3 243 c3 266 -2 305 -50 340 -15 11 -85 39 -155 62 l-128 41 -40 83 -41 84 68 133 c71 141 79 173 53 228 -9 18 -93 110 -188 204 -172 171 -174 172 -218 172 -32 0 -71 -13 -145 -49 -166 -80 -157 -79 -241 -37 -40 20 -76 36 -80 36 -5 0 -26 59 -47 131 -22 72 -48 141 -58 155 -41 51 -58 54 -330 54 -233 0 -255 -2 -285 -20z m504 -310 c25 -74 52 -140 61 -147 10 -7 80 -45 157 -84 100 -51 146 -69 165 -66 14 3 78 31 142 61 65 31 121 56 125 56 5 0 61 -51 126 -112 l117 -113 -65 -125 c-42 -81 -64 -137 -65 -160 0 -21 19 -75 49 -140 27 -58 58 -126 69 -151 22 -52 26 -54 205 -107 l99 -28 -1 -164 0 -163 -73 -24 c-40 -13 -104 -32 -141 -44 -67 -20 -69 -22 -92 -72 -12 -29 -44 -98 -69 -155 -25 -57 -46 -116 -46 -130 1 -15 29 -83 65 -151 l64 -125 -49 -55 c-27 -31 -78 -85 -114 -120 l-65 -65 -135 62 c-75 34 -146 62 -159 62 -31 0 -281 -123 -310 -152 -14 -14 -38 -73 -62 -150 l-40 -128 -176 0 -176 0 -18 66 c-16 61 -70 212 -77 219 -2 1 -68 35 -147 75 -120 60 -151 71 -180 67 -20 -2 -87 -30 -150 -61 -62 -31 -117 -56 -120 -56 -4 0 -60 53 -124 117 l-117 117 65 122 c43 81 65 133 65 155 0 20 -28 96 -68 184 l-67 150 -60 22 c-33 12 -97 32 -142 44 l-83 22 0 164 c0 122 3 165 13 167 6 2 68 21 136 42 144 45 129 29 221 235 46 104 60 146 56 167 -4 15 -35 79 -69 143 l-63 116 116 120 116 120 135 -63 c74 -35 141 -63 149 -63 21 -1 313 142 326 160 6 8 28 68 48 134 21 66 39 125 41 132 3 8 53 11 176 10 l171 -2 45 -135z" />
                            <path
                                d="M4815 3500 c-251 -30 -451 -200 -521 -442 -97 -333 110 -683 452 -764 147 -35 323 -5 460 77 125 75 248 252 275 395 15 81 5 245 -19 314 -64 183 -191 319 -355 382 -44 17 -211 51 -227 47 -3 -1 -32 -5 -65 -9z m241 -231 c132 -62 223 -184 241 -319 12 -89 -1 -162 -42 -247 -134 -273 -520 -306 -710 -61 -51 65 -88 188 -82 265 8 101 44 188 105 254 103 112 195 151 338 145 66 -3 94 -10 150 -37z" />
                            <path
                                d="M2513 3955 c-39 -16 -53 -42 -53 -93 0 -28 7 -45 26 -63 l26 -24 366 -3 c406 -2 403 -3 437 61 l20 37 -20 37 c-11 21 -31 43 -45 50 -38 19 -713 18 -757 -2z" />
                        </g>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Mobile Overlay -->
            <div class="mobile-overlay" id="mobileOverlay"></div>

            <!-- Sidebar - Groups List -->
            <aside class="sidebar">
                <div class="sidebar-header" id="sidebarHeader">
                    <h2 class="sidebar-title">All Notes</h2>
                    <span class="notes-count" id="sidebarStats">0 groups / 0 notes</span>
                </div>
                <button class="btn-new-group" id="newGroupBtn" aria-label="New Group">
                    <span class="btn-icon">+</span>
                    <span>New Group</span>
                </button>
                <div class="groups-list" id="groupsList">
                    <!-- Groups will be dynamically inserted here -->
                </div>
                <!-- Version Footer -->
                <div class="sidebar-footer">
                    <button class="theme-toggle" id="themeToggle" aria-label="Toggle Dark/Light Mode"
                        title="Toggle Theme">
                        <span class="theme-icon">‚òÄÔ∏è</span>
                    </button>
                    <span class="app-version">v1.0.48</span>
                </div>
            </aside>

            <!-- Main Area - Notes or Editor -->
            <section class="main-area">
                <!-- Empty State - No Group Selected -->
                <div class="empty-state" id="emptyState">
                    <div class="empty-state-icon">üìÅ</div>
                    <h2 class="empty-state-title">No Group Selected</h2>
                    <p class="empty-state-text">Select a group from the sidebar to view its notes.</p>
                </div>

                <!-- Notes List View -->
                <div class="notes-view" id="notesView" style="display: none;">
                    <div class="notes-grid" id="notesGrid">
                        <!-- Notes will be dynamically inserted here -->
                    </div>
                    <!-- Floating Action Button for New Note -->
                    <button class="fab-new-note" id="newNoteBtn" aria-label="New Note">
                        <span class="btn-icon">+</span>
                    </button>
                </div>

                <!-- Editor View -->
                <div class="editor-container" id="editorContainer" style="display: none;">
                    <div class="editor-header">
                        <button class="btn-back" id="backToNotesBtn" aria-label="Back to notes">
                            <span>‚Üê</span>
                        </button>
                        <input type="text" class="note-title-input" id="noteTitleInput" placeholder="Note Title"
                            maxlength="100">
                    </div>
                    <textarea class="note-content-input" id="noteContentInput"
                        placeholder="Start typing your note..."></textarea>
                    <div class="editor-footer">
                        <span class="last-edited" id="lastEdited">Last edited: Never</span>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Generic Input Modal -->
    <dialog class="input-modal" id="inputModal">
        <form method="dialog" class="modal-form">
            <h3 class="modal-title" id="modalTitle">Enter Value</h3>

            <div class="input-group">
                <input type="text" class="modal-input" id="modalInput" autocomplete="off" placeholder="Name">
            </div>

            <div class="group-picker-section hidden" id="modalGroupSection">
                <label class="section-label">Category</label>
                <select class="modal-select" id="groupSelector">
                    <!-- Groups will be populated here -->
                </select>
            </div>

            <div class="color-picker-section">
                <label class="section-label">Color</label>
                <div class="color-grid" id="modalColorGrid">
                    <!-- Default/None -->
                    <label class="color-option">
                        <input type="radio" name="color" value="none" checked>
                        <span class="color-circle"
                            style="background: var(--bg-card); border: 2px solid var(--border-color);"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="color" value="coral">
                        <span class="color-circle" style="background: var(--color-coral);"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="color" value="peach">
                        <span class="color-circle" style="background: var(--color-peach);"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="color" value="sand">
                        <span class="color-circle" style="background: var(--color-sand);"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="color" value="mint">
                        <span class="color-circle" style="background: var(--color-mint);"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="color" value="sage">
                        <span class="color-circle" style="background: var(--color-sage);"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="color" value="sky">
                        <span class="color-circle" style="background: var(--color-sky);"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="color" value="lavender">
                        <span class="color-circle" style="background: var(--color-lavender);"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="color" value="rose">
                        <span class="color-circle" style="background: var(--color-rose);"></span>
                    </label>
                </div>
            </div>

            <div class="modal-actions">
                <button type="button" id="modalDeleteBtn" class="btn-text btn-danger hidden"
                    style="margin-right: auto;">Delete Group</button>
                <button value="cancel" class="btn-text">Cancel</button>
                <button value="confirm" class="btn-primary-small">Save</button>
            </div>
        </form>
    </dialog>

    <script src="app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then((registration) => {
                        console.log('‚úÖ Service Worker registered successfully:', registration.scope);
                    })
                    .catch((error) => {
                        console.error('‚ùå Service Worker registration failed:', error);
                    });
            });
        }

        // Handle PWA install prompt
        let deferredPrompt;

        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            console.log('üí° App can be installed!');

            // Optionally, you could show a custom install button here
            // For now, we'll just log it
        });

        window.addEventListener('appinstalled', () => {
            console.log('üéâ App installed successfully!');
            deferredPrompt = null;
        });
    </script>
</body>

</html>